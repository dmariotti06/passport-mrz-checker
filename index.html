<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Contrôle MRZ & conditions de visa France</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0d47a1" />

  <link rel="icon" href="assets/icons/icon-192.png" />
  <link rel="stylesheet" href="style.css" />

  <!-- Tesseract.js OCR -->
  <script src="https://unpkg.com/tesseract.js@5.0.3/dist/tesseract.min.js"></script>
</head>
<body>
  <header class="app-header">
    <h1>Contrôle document & visa France</h1>
    <div id="version-info"></div>
  </header>

  <main>
    <!-- 1. Image du document -->
    <section class="card">
      <h2>1. Image du document</h2>
      <p>Importer une image ou utiliser la caméra.</p>

      <label for="file-input" class="label-inline">Importer une image :</label>
      <input type="file" id="file-input" accept="image/*" />

      <div class="camera-controls">
        <span>Ou utiliser la caméra :</span>
        <button id="open-camera-btn">Ouvrir la caméra</button>
        <button id="capture-btn" disabled>Prendre la photo</button>
      </div>

      <div class="preview-container">
        <video id="camera-video" autoplay playsinline></video>
        <canvas id="preview-canvas"></canvas>
      </div>

      <button id="scan-mrz-btn" disabled>Scanner la MRZ</button>
      <div id="image-status" class="status"></div>
    </section>

    <!-- 2. Résultat MRZ -->
    <section class="card">
      <h2>
        2. Résultat MRZ & document
        <span id="mrz-status-light" class="status-light status-light--unknown"></span>
      </h2>

      <pre id="mrz-raw"></pre>
      <div id="doc-data"></div>
    </section>

    <!-- 3. Évaluation visa -->
    <section class="card">
      <h2>3. Évaluation des conditions de visa</h2>

      <div id="nationality-info" class="field"></div>

      <label for="stay-type">Type de séjour :</label>
      <select id="stay-type">
        <option value="">-- Sélectionner --</option>
        <option value="short">Court séjour (≤ 90 jours / 180)</option>
        <option value="long">Long séjour (> 90 jours)</option>
      </select>

      <label for="purpose">Motif :</label>
      <select id="purpose">
        <option value="">Non précisé</option>
        <option value="tourism">Tourisme</option>
        <option value="business">Affaires</option>
        <option value="family">Famille</option>
        <option value="study">Études</option>
        <option value="other">Autre</option>
      </select>

      <button id="assess-visa-btn" disabled>Évaluer</button>

      <div id="visa-result" class="status"></div>
      <div id="rules-version" class="hint"></div>
    </section>

    <!-- 4. Résumé -->
    <section class="card">
      <h2>4. Résumé</h2>
      <div id="summary"></div>

      <p class="disclaimer">
        Cet outil fournit une aide indicative basée sur la MRZ et les règles locales.
        Ne remplace pas les instructions officielles France-Visas.
      </p>
    </section>
  </main>

  <footer>
    <button id="new-check-btn">Nouveau contrôle</button>
    <button id="check-updates-btn">Mise à jour règles</button>
    <span id="update-status" class="hint"></span>
  </footer>

  <script src="app.js"></script>
</body>
</html>

